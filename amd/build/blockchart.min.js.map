{"version":3,"sources":["../src/blockchart.js"],"names":["define","$","ajax","Chart","images","getSVG","src","request","XMLHttpRequest","open","onload","parser","DOMParser","result","parseFromString","responseText","inlineSVG","getElementsByTagName","setAttribute","svg64","btoa","XMLSerializer","serializeToString","image","Image","canvas","document","createElement","width","height","ctx","getContext","drawImage","img","toDataURL","push","send","init","chartdata","children","each","attr","ctxc","type","plugins","afterDraw","chart","xAxis","scales","yAxis","ticks","forEach","value","index","x","getPixelForTick","bottom","data","labels","datasets","maxBarThickness","options","responsive","maintainAspectRatio","legend","display","tooltips","enabled","elements","rectangle","backgroundColor","borderColor","borderWidth","yAxes","gridLines","suggestedMin","xAxes"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n/*\n * feedbackbox\n *\n * @version    1.0.0\n * @package    mod_feedbackbox\n * @author     Vincent Schneider <vincent.schneider@sudile.com> 2020\n * @copyright  2020 Sudile GbR (http://www.sudile.com)\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/ajax', 'mod_feedbackbox/chart'],\n    function ($, ajax, Chart) {\n        var images = [];\n\n        function getSVG(src) {\n            var request = new XMLHttpRequest();\n            request.open('GET', src, false);\n            request.onload = function () {\n                var parser = new DOMParser();\n                var result = parser.parseFromString(request.responseText, 'text/xml');\n                var inlineSVG = result.getElementsByTagName(\"svg\")[0];\n                inlineSVG.setAttribute('width', '30px');\n                inlineSVG.setAttribute('height', '30px');\n                var svg64 = btoa(new XMLSerializer().serializeToString(inlineSVG));\n                var img64 = 'data:image/svg+xml;base64,' + svg64;\n                var image = new Image();\n                image.src = img64;\n                image.onload = function () {\n                    var canvas = document.createElement(\"canvas\");\n                    canvas.width = this.width;\n                    canvas.height = this.height;\n                    var ctx = canvas.getContext(\"2d\");\n                    ctx.drawImage(this, 0, 0);\n                    var img = new Image();\n                    img.src = canvas.toDataURL(\"image/png\");\n                    images.push(img);\n                };\n            };\n            request.send();\n        }\n\n        var obj = {\n            init: function (chartdata) {\n                $('#feedbackboxicons').children().each(function () {\n                    getSVG($(this).attr('src'));\n                });\n                let ctxc = $('#studchartblock');\n                new Chart(ctxc, {\n                    type: 'bar',\n                    plugins: [{\n                        afterDraw: chart => {\n                            var ctx = chart.chart.ctx;\n                            var xAxis = chart.scales['x-axis-0'];\n                            var yAxis = chart.scales['y-axis-0'];\n                            yAxis.ticks.forEach((value, index) => {\n                                if (index in images) {\n                                    var x = xAxis.getPixelForTick(index);\n                                    if (x !== undefined && x !== null) {\n                                        ctx.drawImage(images[index], x - 15, yAxis.bottom, 30, 30);\n                                    }\n                                }\n                            });\n                        }\n                    }],\n                    data: {\n                        labels: ['', '', '', ''],\n                        datasets: [{\n                            data: chartdata.data,\n                            maxBarThickness: 50,\n                        }],\n                    },\n                    options: {\n                        responsive: true,\n                        maintainAspectRatio: false,\n                        legend: {\n                            display: false\n                        },\n                        tooltips: {\n                            enabled: true\n                        },\n                        elements: {\n                            rectangle: {\n                                backgroundColor: 'rgba(255, 172, 37, 0.2)',\n                                borderColor: 'rgba(255, 172, 37, 1)',\n                                borderWidth: 2\n                            }\n                        },\n                        scales: {\n                            yAxes: [{\n                                display: false,\n                                gridLines: {\n                                    display: false\n                                },\n                                ticks: {\n                                    suggestedMin: 0,\n                                }\n                            }],\n                            xAxes: [{\n                                gridLines: {\n                                    display: false\n                                }\n                            }],\n                        }\n                    }\n                });\n            }\n        };\n        return obj;\n    }\n);\n"],"file":"blockchart.min.js"}